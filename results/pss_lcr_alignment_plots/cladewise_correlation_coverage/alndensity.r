args = commandArgs(trailingOnly=TRUE)
if (length(args)<4) {
  stop("Please provide arguments like Rscript alndensity.r sitefile LCRfile alndensityfile cladename", call.=FALSE)
}
library(stringr)
s=read.table(args[1])
r=read.table(args[2])
a=read.table(args[3])
clade=tolower(args[4])
cname=str_to_title(clade)
t=cbind(a,hist(s$V2,breaks=100,plot=F)$density)
t=cbind(t,hist(r$V2,breaks=100,plot=F)$density)
colnames(t)=c("breaks","Alignment_coverage","Positive_sites","LCRs_location")
jpeg(paste('Positive_LCR_coverage_distribution_in_',cname,'.jpeg',sep=''),width=28,height=18,units="in",res=300)
par(mar=c(5.1,5.1,5,2.1))
tt=paste('Density distribution on normalized gene position in',cname,'clade',sep=" ")
plot(t$Alignment_coverage/20,type='l',col="darkorchid4",lwd=3,ylim=c(0,0.05),xlab="Normalized gene position",ylab="Density",main=tt,cex.main=2.5,cex.lab=2,cex.axis=2)
lines(t$Positive_sites,lwd=3,col="hotpink2")
lines(t$LCRs_location,lwd=3,col="salmon2")
legend(80,0.03,box.col="white",bg ="white", box.lwd =0,legend=c("Alignment coverage", "Positive sites","LCRs location"),fill = c("darkorchid4","hotpink2","salmon2"),cex=2)
dev.off()
library(corrplot)
b3=t[,-1]
m=cor(b3,method="kendall")
testRes = cor.mtest(b3, conf.level = 0.95)
jpeg(paste('Positive_LCR_coverage_corrplot_in_',cname,'.jpeg',sep=''),width=10,height=11,units="in",res=300)
par(mar=c(1,3,10,2.1))
corrplot(m,p.mat = testRes$p, method="shade",title="",order ="hclust",hclust.method="complete",insig="blank",addCoef.col ='white',sig.level=0.05,tl.col = "black",tl.cex=2)
dev.off()

